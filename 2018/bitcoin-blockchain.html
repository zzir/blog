<!DOCTYPE html>
<html lang="zh"><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="zzir">
    <meta name="description" content="The architect of civilization.">
    <meta name="keywords" content="zzir,Golang,Python,Docker,K8S">

    <link rel="stylesheet" href="/assets/css/style.css">

    <link href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"
          type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Caveat&display=swap" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css">
    <script defer src="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.js"></script>
    <script defer src="https://cdn.staticfile.org/KaTeX/0.11.1/contrib/auto-render.min.js"></script>

    <link rel="stylesheet" href="/assets/css/github.css">
    <script src="/assets/js/highlight.pack.js"></script>
    <title>Bitcoin åŒºå—å’Œäº¤æ˜“æ•°æ®ç»“æ„ - ZZIR's Blog</title>

    <script>
        hljs.initHighlightingOnLoad();
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false},
                    {left: "\\(", right: "\\)", display: false},
                    {left: "\\[", right: "\\]", display: true}
                ]
            });
        });
    </script>
</head><body>
<main class="page-content" aria-label="Content">
    <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="post-back" id="post-back" style="display: none">
        <a class="black-link" href="https://zzir.cn">ğŸ™„</a>
    </div>
    <header class="post-header">
        <h1 class="post-title p-name" itemprop="name headline">
            Bitcoin åŒºå—å’Œäº¤æ˜“æ•°æ®ç»“æ„
        </h1>
        <p class="post-meta">
            <time class="dt-published" datetime="2018-07-10T00:00:00+08:00" itemprop="datePublished">Jul 10, 2018
            </time></p>
    </header>

    <div class="post-content e-content" itemprop="articleBody">
        <p><img src="/imgs/201807-blockchain.png" alt="" /></p>

<p>åŒºå—é“¾æ˜¯ä¸€ç§è´¦æœ¬æ•°æ®åº“ï¼Œåˆ†å¸ƒå¼ï¼Œæ•°æ®å­˜å‚¨çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šåŒæ­¥å¤åˆ¶æ•´ä¸ªè´¦æœ¬ï¼Œä¿¡æ¯é€æ˜éš¾ä»¥ç¯¡æ”¹ã€‚</p>

<p>åŒºå—ä¸­å­˜æ”¾ç€äº¤æ˜“ï¼ŒåŒºå—æŒ‰ç…§é«˜åº¦æœ‰åºé“¾æ¥èµ·æ¥çš„è¿™ç§æ•°æ®ç»“æ„è¢«ç§°ä¸ºåŒºå—é“¾ã€‚æ¯ä¸ªåŒºå—éƒ½æŒ‡å‘å‰ä¸€ä¸ªåŒºå—ï¼Œä¸€ä¸ªåŒºå—ç”± <a href="#åŒºå—å¤´">åŒºå—å¤´</a> å’Œ <a href="#äº¤æ˜“">äº¤æ˜“</a> ç»„æˆã€‚</p>

<h2 id="åŒºå—">åŒºå—</h2>

<p>åŒºå—ç”±ä¸€ä¸ªåŒ…å«å…ƒæ•°æ®çš„åŒºå—å¤´å’Œç´§è·Ÿå…¶åçš„æ„æˆåŒºå—ä¸»ä½“çš„ä¸€é•¿ä¸²äº¤æ˜“åˆ—è¡¨ç»„æˆã€‚åŒºå—ç»“æ„å¦‚å›¾ï¼š</p>

<p><img src="/imgs/201807-block.png" alt="" /></p>

<p>åŒºå—å¤´ä¸­æ•°æ®æœ‰ï¼š</p>
<ul>
  <li>åŒºå—ç‰ˆæœ¬</li>
  <li>å‰ä¸ªåŒºå—å“ˆå¸Œ</li>
  <li>Merkle Root å“ˆå¸Œ</li>
  <li>æ—¶é—´æˆ³</li>
  <li>Bits éš¾åº¦</li>
  <li>Nonce â€œæŒ–çŸ¿â€ éšæœºæ•°</li>
</ul>

<p>Coinbase äº¤æ˜“ï¼šæ¯ä¸ªåŒºå—ä¸­çš„ç¬¬ä¸€æ¡äº¤æ˜“éƒ½æ˜¯ Coinbase äº¤æ˜“ï¼Œç”¨äºå¥–åŠ± â€œçŸ¿å·¥â€ å°†äº¤æ˜“æ‰“åŒ…åˆ°åŒºå—ã€‚å¥–åŠ±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯åŒºå—å¥–åŠ±ï¼Œä¸€æ˜¯åŒºå—ä¸­é™¤ Coinbase äº¤æ˜“å¤–å…¶å®ƒäº¤æ˜“æ‰‹ç»­è´¹æ€»å’Œã€‚</p>

<!--more-->

<h3 id="åŒºå—å¤´">åŒºå—å¤´</h3>

<p>åŒºå—å¤´çš„é•¿åº¦æ˜¯80å­—èŠ‚ï¼Œå°†åŒºå—å¤´æ•°æ®è¿›è¡Œä¸¤æ¬¡ <code class="highlighter-rouge">Sha256</code> è¿ç®—å°†å¾—åˆ°<strong>åŒºå—å“ˆå¸Œ</strong>ã€‚</p>

<p>åŒºå—å¤´ç»“æ„å¦‚ä¸‹ï¼š</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Size</th>
      <th>Data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Version</td>
      <td>4 bytes</td>
      <td><a href="#Little-Endian">Little-endian</a> âŸ²</td>
    </tr>
    <tr>
      <td>Previous Block Hash</td>
      <td>32 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
    <tr>
      <td>MerkleRoot</td>
      <td>32 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
    <tr>
      <td>Timestamp</td>
      <td>4 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
    <tr>
      <td>Bits (Difficulty Target)</td>
      <td>4 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
    <tr>
      <td>Nonce</td>
      <td>4 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
  </tbody>
</table>

<h3 id="merkle-root">Merkle Root</h3>

<p>Merkle Tree æ˜¯ä¸€ç§å“ˆå¸ŒäºŒå‰æ ‘ï¼Œç”¨äºå½’çº³ä¸€ä¸ªåŒºå—ä¸­çš„æ‰€æœ‰äº¤æ˜“ï¼ŒåŒæ—¶ç”Ÿæˆæ•´ä¸ªäº¤æ˜“é›†åˆçš„æ•°å­—ç­¾åï¼Œä¸”æä¾›äº†ä¸€ç§æ ¡éªŒåŒºå—æ˜¯å¦å­˜åœ¨æŸäº¤æ˜“çš„é«˜æ•ˆé€”å¾„ã€‚</p>

<p>åŒºå—é“¾ä¸­çš„æ¯ä¸ªåŒºå—éƒ½åŒ…å«äº†äº§ç”Ÿäºè¯¥åŒºå—çš„æ‰€æœ‰äº¤æ˜“ï¼Œä¸”ä»¥Merkleæ ‘è¡¨ç¤ºã€‚é‚£ä¹ˆå¦‚ä½•è·å¾—å®ƒå‘¢ï¼Ÿ</p>

<ol>
  <li>ä»åŒºå—äº¤æ˜“åˆ—è¡¨ä¸­è·å–æ¯å¯¹Txidï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œä¸¤æ¬¡ <code class="highlighter-rouge">Sha256</code> è¿ç®—ï¼Œå¾—åˆ°å“ˆå¸Œã€‚</li>
  <li>å¦‚æœä¸ºå¥‡æ•°ï¼Œåˆ™å¤åˆ¶ä¸€ä»½å‡‘æˆå¶æ•°å†è¿›è¡Œä¸¤æ¬¡ <code class="highlighter-rouge">Sha256</code> è¿ç®—ï¼Œå¾—åˆ°å“ˆå¸Œã€‚</li>
  <li>é€’å½’1ã€2ï¼Œç›´åˆ°æœ€ç»ˆè·å¾—ä¸€ä¸ªå“ˆå¸Œï¼Œå®ƒå°±æ˜¯Merkle Rootã€‚</li>
</ol>

<p><img src="/imgs/201807-merkleroot.png" alt="" /></p>

<p>ä¸ºä»€ä¹ˆä½¿ç”¨ Merkle Root æ–¹å¼å‘¢ï¼Œä¸ºä»€ä¹ˆä¸å¯¹åŒºå—å†…æ‰€ä»¥äº¤æ˜“ä¸€æ¬¡æ€§è¿›è¡Œå“ˆå¸Œå‘¢ï¼Œé‚£æ ·ä¸æ˜¯æ›´å¿«ä¹ˆï¼Ÿ</p>

<p>ä½¿ç”¨ Merkle Root åŸå› æœ‰äºŒï¼š</p>
<ol>
  <li>å®Œæ•´æ€§éªŒè¯ï¼Œä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹çš„å“ˆå¸Œå‘ç”Ÿå˜åŒ–ï¼Œéƒ½ä¼šå¯¼è‡´æœ€ç»ˆçš„ Root èŠ‚ç‚¹å“ˆå¸Œå‘ç”Ÿå˜åŒ–ã€‚è¿™ä¸€ç‰¹æ€§ä¹Ÿå¯ç”¨äºå¿«é€Ÿå®šä½é—®é¢˜èŠ‚ç‚¹ã€‚</li>
  <li>é›¶çŸ¥è¯†è¯æ˜ï¼Œå¦‚ä¸‹å›¾ï¼Œ16 æ¡äº¤æ˜“çš„èŠ‚ç‚¹èƒ½å¤Ÿé€šè¿‡ç”Ÿæˆä¸€æ¡ä»…æœ‰ 4 ä¸ª 32 å­—èŠ‚å“ˆå¸Œå€¼é•¿åº¦(æ€»128å­—èŠ‚)çš„ Merkle è·¯å¾„ï¼Œæ¥è¯æ˜åŒºå—ä¸­å­˜åœ¨ä¸€ç¬”äº¤æ˜“ <code class="highlighter-rouge">K</code>ï¼Œè¯¥è·¯å¾„æœ‰4ä¸ªå“ˆå¸Œå€¼ H<sub>L</sub>ã€H<sub>IJ</sub>ã€H<sub>MNOP</sub> å’Œ H<sub>ABCDEFGH</sub>ã€‚ç”±è¿™4ä¸ªå“ˆå¸Œå€¼äº§ç”Ÿçš„è®¤è¯è·¯å¾„ï¼Œå†é€šè¿‡è®¡ç®—å¦å¤–å››å¯¹å“ˆå¸Œå€¼ H<sub>KL</sub>ã€H<sub>IJKL</sub>ã€H<sub>IJKLMNOP</sub> å’Œ Merkle Rootï¼Œä»»ä½•èŠ‚ç‚¹éƒ½èƒ½è¯æ˜ H<sub>K</sub> åŒ…å«åœ¨Merkle Rootã€‚
<img src="/imgs/201807-merkleroot-check.png" alt="å›¾æ¥è‡ªhttps://github.com/bitcoinbook/bitcoinbook/" /></li>
</ol>

<p>å…³äº Merkle è·¯å¾„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€å¼ å›¾ï¼š</p>

<table>
  <thead>
    <tr>
      <th>äº¤æ˜“æ•°é‡</th>
      <th>åŒºå—å¤§å°</th>
      <th>è·¯å¾„æ•°é‡</th>
      <th>è·¯å¾„å¤§å°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>16</td>
      <td>4 KB</td>
      <td>4</td>
      <td>128 bytes</td>
    </tr>
    <tr>
      <td>512</td>
      <td>128 KB</td>
      <td>9</td>
      <td>288 bytes</td>
    </tr>
    <tr>
      <td>2048</td>
      <td>512 KB</td>
      <td>11</td>
      <td>352 bytes</td>
    </tr>
    <tr>
      <td>4096</td>
      <td>1 MB</td>
      <td>12</td>
      <td>384 bytes</td>
    </tr>
    <tr>
      <td>65,535</td>
      <td>16 MB</td>
      <td>16</td>
      <td>512 bytes</td>
    </tr>
  </tbody>
</table>

<p>å³ä½¿å¢é•¿åˆ°äº¤æ˜“æ•°é‡ä¸º 262144ï¼ŒåŒºå—å¤§å°åˆ° 65Mï¼Œè·¯å¾„æ•°ä¹Ÿæ‰ 18ã€‚æ‰€ä»¥ä½¿ç”¨ Merkle Root éå¸¸é«˜æ•ˆï¼Œå¦‚æœæ˜¯æ‰€æœ‰äº¤æ˜“è¿›è¡Œä¸€æ¬¡å“ˆå¸Œï¼Œè™½ç„¶è·å¾— Hash æ˜¯å¿«äº›ï¼Œä½†å¯¹äºè¦éªŒè¯é—®é¢˜äº¤æ˜“æˆ–èŠ‚ç‚¹ï¼Œå°†æ˜¯ä¸ªç¾éš¾ã€‚</p>

<h3 id="bits-å’Œ-nonce">Bits å’Œ Nonce</h3>

<p>Bits æ˜¯æŒ–çŸ¿ç›®æ ‡éš¾åº¦ Target çš„ç´§å‡‘æ ¼å¼ã€‚</p>

<p>Nonce æ˜¯æŒ–çŸ¿éå†æ—¶çš„éšæœºæ•°ã€‚</p>

<p>å…³äº â€œæŒ–çŸ¿â€ çš„å…·ä½“å†…å®¹ï¼Œæˆ‘ä¼šå•ç‹¬æ€»ç»“ä¸€ç¯‡ï¼Œæ„Ÿå…´è¶£å¯ä»¥å…³æ³¨åç»­æ–‡ç« ã€‚
è¿™é‡Œæœ‰ä¸€ä¸ªåœ¨çº¿çš„æ¨¡æ‹ŸæŒ–çŸ¿ï¼Œå„ç§æ•°æ®æ˜¾ç¤ºéƒ½å¾ˆç›´è§‚ï¼Œé€‚åˆäº†è§£æŒ–çŸ¿å†…éƒ¨è¿ä½œï¼š<a href="http://yogh.io/#mine:last">ç‚¹æˆ‘å‰å¾€æ¨¡æ‹ŸæŒ–çŸ¿</a></p>

<h2 id="äº¤æ˜“">äº¤æ˜“</h2>

<p>ç›®å‰å­˜åœ¨ä¸¤ç§äº¤æ˜“ç»“æ„ã€‚æ¯”ç‰¹å¸ç™½çš®ä¹¦ä¸­å®šä¹‰çš„äº¤æ˜“ç»“æ„å’Œæ–°çš„éš”ç¦»è§è¯äº¤æ˜“ç»“æ„ã€‚</p>

<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki">BIP 141</a> å®šä¹‰ä¸€ç§æ–°çš„äº¤æ˜“ç»“æ„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º â€œ<a href="https://zzir.io/2017/bitcoin-segwit/">Segregated Witness (éš”ç¦»è§è¯)</a>â€ äº¤æ˜“ã€‚æ—§äº¤æ˜“ç»“æ„ç­¾åæ•°æ®æ”¾åœ¨äº¤æ˜“è¾“å…¥é‡Œï¼Œéš”ç¦»è§è¯äº¤æ˜“åˆ™å°†ç­¾åæ•°æ® â€œåˆ†ç¦»â€ å‡ºæ¥ï¼Œæ”¾åœ¨äº¤æ˜“çš„ <code class="highlighter-rouge">Locktime</code> ä¹‹å‰ã€‚</p>

<p>äº¤æ˜“ç»“æ„ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[nVersion] [n] [tx inputs] [n] [tx outputs] [nLockTime]
    |       |               |                    |
 4 bytes  varint          varint             4 bytes
</code></pre></div></div>
<p>éš”ç¦»è§è¯(Segregated Witness)äº¤æ˜“ç»“æ„ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[nVersion] [marker] [flag][n] [tx inputs] [n] [tx outputs] [witness][nLockTime]
    |       \    /   \  /  |               |                \     /     |
 4 bytes     0x00    0x01 varint         varint            scriptSig  4 bytes
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Size</th>
      <th>Data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Version</td>
      <td>4 bytes</td>
      <td><a href="#Little-Endian">Little-endian</a> âŸ²</td>
    </tr>
    <tr>
      <td>* Marker</td>
      <td>1 bytes</td>
      <td>0x00</td>
    </tr>
    <tr>
      <td>* Flag</td>
      <td>1 bytes</td>
      <td>0x01</td>
    </tr>
    <tr>
      <td>Input Counter</td>
      <td>1â€“9 bytes</td>
      <td><a href="#VarInt">VarInt</a></td>
    </tr>
    <tr>
      <td><a href="#Inputs">Inputs</a></td>
      <td>Variable</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>Output Counter</td>
      <td>1â€“9 bytes</td>
      <td><a href="#VarInt">VarInt</a></td>
    </tr>
    <tr>
      <td><a href="#outputs">Outputs</a></td>
      <td>Variable</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>* Witness</td>
      <td>Variable</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>Locktime</td>
      <td>4 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
  </tbody>
</table>

<p><code class="highlighter-rouge">*</code> ä¸º Segregated Witness äº¤æ˜“å­—æ®µã€‚</p>

<p>æˆ‘ä»¬è§£æä¸€æ¡ Segregated Witness (P2SH-P2WPKH)äº¤æ˜“ï¼š</p>

<p>å¦‚æœä½ å¯¹ <a href="https://zzir.io/2017/bitcoin-segwit/#P2SH-P2WPKH">P2SH-P2WPKH</a> äº¤æ˜“æ„Ÿå…´è¶£å¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰å†™çš„ä¸€ç¯‡ä»‹ç» Segregated Witness çš„æ–‡ç« ã€‚</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"txid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"af0c4cdd2537ae367b0e03db0cd795fa37543bd672c9234b2c307009a9a8108f"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ff300093626745127aad29e8628ee4606b87cb660f7ff63817dd4857cd15a175"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">248</span><span class="p">,</span><span class="w">
  </span><span class="nl">"vsize"</span><span class="p">:</span><span class="w"> </span><span class="mi">166</span><span class="p">,</span><span class="w">
  </span><span class="nl">"locktime"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"vin"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"vout"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>HEX æ•°æ®ï¼š</p>

<p><img src="/imgs/201807-tx-hex.png" alt="" /></p>

<h3 id="inputs">Inputs</h3>

<p>äº¤æ˜“è¾“å…¥ç»“æ„ï¼š</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Size</th>
      <th>Data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>TXID</td>
      <td>32 bytes</td>
      <td><a href="#Little-Endian">Little-endian</a> âŸ²</td>
    </tr>
    <tr>
      <td>VOUT</td>
      <td>4 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
    <tr>
      <td>ScriptSig Size</td>
      <td>1â€“9 bytes</td>
      <td><a href="#VarInt">VarInt</a></td>
    </tr>
    <tr>
      <td>ScriptSig</td>
      <td>Variable</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>Sequence</td>
      <td>4 bytes</td>
      <td>Little-endian âŸ²</td>
    </tr>
  </tbody>
</table>

<p>è¾“å…¥JSONï¼š</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"txid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6635d3f451478f0e1f88692d5cfb9194f133fbb314cb87fa9483f89bd296284b"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"vout"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scriptSig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0014db75523757a256579a197746568f331103417b85"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"160014db75523757a256579a197746568f331103417b85"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"txinwitness"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"3045022100c8b2a6027f939bb964e395c94cd6f1d8ff9d1f406e41975b2ac979a6007c3ac4022019953dfe376d0152152955e02d72e7a7b9a61f8d5700642c97a2dc4ba13628b801"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"02983f3687310bcfe2ad1ad55d011112c3f8d659950c10cab9ff43ae34d7b6280e"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">4294967293</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="outputs">outputs</h3>

<p>äº¤æ˜“è¾“å‡ºç»“æ„ï¼š</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Size</th>
      <th>Data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Value</td>
      <td>8 bytes</td>
      <td><a href="#Little-Endian">Little-endian</a> âŸ²</td>
    </tr>
    <tr>
      <td>ScriptPubKey Size</td>
      <td>1â€“9 bytes</td>
      <td><a href="#VarInt">VarInt</a></td>
    </tr>
    <tr>
      <td>ScriptPubKey</td>
      <td>Variable</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p>è¾“å‡ºJSONï¼š</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.00000000</span><span class="p">,</span><span class="w">
  </span><span class="nl">"n"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scriptPubKey"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OP_HASH160 2228cecac3c1fa3143ba2ac7d2525d8b9b05c87b OP_EQUAL"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a9142228cecac3c1fa3143ba2ac7d2525d8b9b05c87b87"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"reqSigs"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scripthash"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"addresses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"2MvMqrBRct4F2zuyrpgrq2qqq61VZc1znPB"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">48.99996680</span><span class="p">,</span><span class="w">
  </span><span class="nl">"n"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scriptPubKey"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OP_HASH160 22e2f5339cdf0778935e8127dc51e4a0ae62d162 OP_EQUAL"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a91422e2f5339cdf0778935e8127dc51e4a0ae62d16287"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"reqSigs"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scripthash"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"addresses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"2MvRgr7SeyTVutrUaJdmZ5ETVdoPp5eWoj5"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="varint">VarInt</h3>
<p>æ¯”ç‰¹å¸ä½¿ç”¨å¯å˜å­—èŠ‚è¡¨ç¤ºè„šæœ¬é•¿åº¦ï¼Œå½“ä¸€ä¸ªå­—èŠ‚ä¸å¤Ÿè¡¨ç¤ºæ—¶ï¼Œå¦‚ä¸‹è§„å¾‹ï¼š</p>

<table>
  <thead>
    <tr>
      <th>Size</th>
      <th>Example</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;= <code class="highlighter-rouge">0xfc</code></td>
      <td>0x12</td>
      <td>1 ä¸ªå­—èŠ‚</td>
    </tr>
    <tr>
      <td>&lt;= <code class="highlighter-rouge">0xffff</code></td>
      <td>0xfd1234</td>
      <td>å‰ç¼€æ˜¯<code class="highlighter-rouge">fd</code>ï¼Œå°ç«¯è¡¨ç¤ºæ¥ä¸‹æ¥çš„2ä¸ªå­—èŠ‚</td>
    </tr>
    <tr>
      <td>&lt;= <code class="highlighter-rouge">0xffffffff</code></td>
      <td>0xfe12345678</td>
      <td>å‰ç¼€æ˜¯<code class="highlighter-rouge">fe</code>ï¼Œå°ç«¯è¡¨ç¤ºæ¥ä¸‹æ¥çš„4ä¸ªå­—èŠ‚</td>
    </tr>
    <tr>
      <td>&lt;= <code class="highlighter-rouge">0xffffffffffffffff</code></td>
      <td>0xff1234567890abcdef</td>
      <td>å‰ç¼€æ˜¯<code class="highlighter-rouge">ff</code>ï¼Œå°ç«¯è¡¨ç¤ºæ¥ä¸‹æ¥çš„8ä¸ªå­—èŠ‚</td>
    </tr>
  </tbody>
</table>

<p>å¦‚ï¼š<code class="highlighter-rouge">0x48</code>ï¼Œæ²¡æœ‰ <code class="highlighter-rouge">fd</code>ã€<code class="highlighter-rouge">fe</code>ã€<code class="highlighter-rouge">ff</code> å‰ç¼€ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯2 bytesè¡¨ç¤ºçš„ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>VarInt: 0x48
        = 72 bytes
</code></pre></div></div>

<p>å¦‚ï¼š<code class="highlighter-rouge">fd2606</code>ï¼Œå› ä¸ºæ˜¯ <code class="highlighter-rouge">fd</code> å‰ç¼€ï¼Œæˆ‘ä»¬è¯»å–<code class="highlighter-rouge">fd</code>ä¹‹åçš„ 4 bytesï¼Œåè½¬å°ç«¯å†è½¬æ¢ä¸ºåè¿›åˆ¶è¡¨ç¤ºã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>VarInt: 0xfd2606
        = 0x2602    (next 2 bytes)
        = 0x0226    (Little-Endian)
        = 550 bytes
</code></pre></div></div>

<h3 id="little-endian">Little-Endian</h3>
<p>å°ç«¯ (Little-endian) å­—èŠ‚åºã€‚å¦‚ï¼š<code class="highlighter-rouge">0x12345678</code></p>

<p>å¤§ç«¯ç±»ä¼¼äºåå…­è¿›åˆ¶å­—èŠ‚ä»å·¦åˆ°å³çš„é˜…è¯»é¡ºåºã€‚å°ç«¯æœ€ä½ä½å­—èŠ‚æ˜¯ <code class="highlighter-rouge">0x78</code> å­˜å‚¨åœ¨æœ€ä½çš„å†…å­˜åœ°å€å¤„ï¼Œåé¢çš„å­—èŠ‚ä¾æ¬¡å¾€åå­˜ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Big-Endian:    |12|34|56|78|
Little-Endian: |78|56|34|12|
</code></pre></div></div>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
  <li>https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch09.asciidoc</li>
  <li>http://learnmeabitcoin.com/glossary/</li>
  <li>http://learnmeabitcoin.com/glossary/merkle-root</li>
  <li>http://learnmeabitcoin.com/glossary/varint</li>
  <li>http://yogh.io/#mine:last</li>
  <li>http://royalforkblog.github.io/2014/11/20/txn-demo/</li>
</ul>

    </div>

    <a class="u-url" href="/2018/bitcoin-blockchain.html" hidden></a>
</article>

<div class="post-tags">
    
    <a>Blockchain</a>
    
    <a>Bitcoin</a>
    
</div>

<div class="pagination">
    <ul>
        
        <li class="prev">
            <a href="/2018/caddy-server-ratelimit.html" title="PREV: Caddy Server è®¿é—®é¢‘ç‡é™åˆ¶">
                â€¹ Caddy Server è®¿é—®é¢‘ç‡é™åˆ¶
            </a>
        </li>
        
        
        <li class="next">
            <a href="/2019/golang-sort.html" title="NEXT: Golang æ’åºç®—æ³•å®ç°">
                â€º Golang æ’åºç®—æ³•å®ç°
            </a>
        </li>
        
    </ul>
</div>
    </div>
</main><footer>
    <p class="post-author">Â© <a href="/">zzir</a></p>
    <p class="beian">
        
        <span>
            <img src="/assets/imgs/beian.png">
            <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010902002287">æµ™å…¬ç½‘å®‰å¤‡33010902002287å·</a>
        </span>
        ãƒ»ï¸
        <span><a href="http://beian.miit.gov.cn/">æµ™ICPå¤‡19040093å·</a></span>
        
    </p>
</footer>

<script>
    // analytics
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?fa1df30338e49443514335c65bd9b8d6";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();

    // back display
    function getScrollTop() {
        var scrollTop = 0;
        if (document.documentElement && document.documentElement.scrollTop) {
            scrollTop = document.documentElement.scrollTop;
        } else if (document.body) {
            scrollTop = document.body.scrollTop;
        }
        return scrollTop;
    }

    window.onscroll = function () {
        if (getScrollTop() === 0) {
            document.getElementById("post-back").style.display = "block";
        }
    }
</script>

</body>
</html>