<!DOCTYPE html>
<html lang="zh"><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="ZZIR">
    <meta name="description" content="fun~">
    <meta name="keywords" content="zzir,Golang,Python,Docker,K8S">

    <link rel="stylesheet" href="/assets/css/style.css">

    <link href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css">
    <link rel="stylesheet" href="/assets/css/github.css">

    <title>Python å¤šçº¿ç¨‹å’Œé” - ZZIR's Note</title>
</head><body>
<main class="page-content" aria-label="Content">
    <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="post-back" id="post-back" style="display: none">
        <a class="black-link" href="https://zzir.cn">ğŸ™„</a>
    </div>
    <header class="post-header">
        <h1 class="post-title p-name" itemprop="name headline">
            Python å¤šçº¿ç¨‹å’Œé”
        </h1>
        <p class="post-meta">
            <time class="dt-published" datetime="2017-04-05T00:00:00+08:00" itemprop="datePublished">Apr 5, 2017
            </time></p>
    </header>

    <div class="post-content e-content" itemprop="articleBody">
        <h2 id="è¿›ç¨‹å’Œçº¿ç¨‹">è¿›ç¨‹å’Œçº¿ç¨‹</h2>
<p>è¿›ç¨‹æ˜¯æ‰§è¡Œä¸­çš„è®¡ç®—æœºç¨‹åºã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ã€å†…å­˜ã€æ•°æ®æ ˆåŠå…¶å®ƒçš„è¾…åŠ©æ•°æ®ã€‚æ“ä½œç³»ç»Ÿç®¡ç†ç€æ‰€æœ‰çš„è¿›ç¨‹ï¼Œå¹¶ä¸ºè¿™äº›è¿›ç¨‹åˆç†åˆ†é…æ—¶é—´ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡æ´¾ç”Ÿæ–°çš„è¿›ç¨‹æ¥æ‰§è¡Œå…¶å®ƒä»»åŠ¡ï¼Œä¸è¿‡æ¯ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„å†…å­˜å’Œæ•°æ®æ ˆç­‰ï¼Œè¿›ç¨‹ä¹‹é—´çš„æ•°æ®äº¤æ¢é‡‡ç”¨ <strong>è¿›ç¨‹é—´é€šä¿¡(IPC)</strong> æ–¹å¼ã€‚</p>

<p>çº¿ç¨‹åœ¨è¿›ç¨‹ä¹‹ä¸‹æ‰§è¡Œï¼Œä¸€ä¸ªè¿›ç¨‹ä¸‹å¯ä»¥è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬ä¹‹é—´å…±äº«ç›¸åŒä¸Šä¸‹æ–‡ã€‚çº¿ç¨‹åŒ…æ‹¬å¼€å§‹ã€æ‰§è¡Œé¡ºåºå’Œç»“æŸä¸‰éƒ¨åˆ†ã€‚å®ƒæœ‰ä¸€ä¸ªæŒ‡é’ˆï¼Œç”¨äºè®°å½•å½“å‰è¿è¡Œçš„ä¸Šä¸‹æ–‡ã€‚å½“å…¶å®ƒçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå®ƒå¯ä»¥è¢«æŠ¢å (ä¸­æ–­)å’Œä¸´æ—¶æŒ‚èµ·(ä¹Ÿç§°ç¡çœ ) â€”â€”è¿™ç§åšæ³•å«åš <strong>è®©æ­¥(yielding)</strong>ã€‚</p>

<p>ä¸€ä¸ªè¿›ç¨‹ä¸­çš„å„ä¸ªçº¿ç¨‹ä¸ä¸»è¿›ç¨‹å…±äº«åŒä¸€ç‰‡æ•°æ®ç©ºé—´ï¼Œä¸ç‹¬ç«‹è¿›ç¨‹ç›¸æ¯”ï¼Œçº¿ç¨‹ä¹‹é—´ä¿¡æ¯å…±äº«å’Œé€šä¿¡æ›´åŠ å®¹æ˜“ã€‚çº¿ç¨‹ä¸€èˆ¬ä»¥å¹¶å‘æ‰§è¡Œï¼Œæ­£æ˜¯ç”±äºè¿™ç§å¹¶å‘å’Œæ•°æ®å…±äº«æœºåˆ¶ï¼Œä½¿å¤šä»»åŠ¡é—´çš„åä½œæˆä¸ºå¯èƒ½ã€‚å½“ç„¶ï¼Œè¿™ç§å…±äº«ä¹Ÿå¹¶ä¸æ˜¯æ²¡æœ‰é£é™©çš„ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€æ•°æ®ç©ºé—´ï¼Œç”±äºè®¿é—®é¡ºåºä¸åŒï¼Œå¯èƒ½å¯¼è‡´ç»“æœä¸ä¸€è‡´ï¼Œè¿™ç§æƒ…å†µé€šå¸¸ç§°ä¸º<strong>ç«æ€æ¡ä»¶(race condition)</strong>ï¼Œä¸è¿‡å¤§å¤šæ•°çº¿ç¨‹åº“éƒ½æœ‰åŒæ­¥åŸè¯­ï¼Œä»¥å…è®¸çº¿ç¨‹ç®¡ç†å™¨çš„æ§åˆ¶æ‰§è¡Œå’Œè®¿é—®ï¼›å¦ä¸€ä¸ªè¦æ³¨æ„çš„é—®é¢˜æ˜¯ï¼Œçº¿ç¨‹æ— æ³•ç»™äºˆå…¬å¹³æ‰§è¡Œæ—¶é—´ï¼ŒCPU æ—¶é—´åˆ†é…ä¼šå€¾å‘é‚£äº›é˜»å¡æ›´å°‘çš„å‡½æ•°ã€‚</p>

<h2 id="å…¨å±€è§£é‡Šå™¨é”gil">å…¨å±€è§£é‡Šå™¨é”(GIL)</h2>
<p>Python ä»£ç æ‰§è¡Œç”± <em>Python è™šæ‹Ÿæœº</em> (åˆåè§£é‡Šå™¨ä¸»å¾ªç¯) è¿›è¡Œæ§åˆ¶ã€‚Python åœ¨è®¾è®¡æ—¶æ˜¯è¿™æ ·è€ƒè™‘çš„ï¼Œåœ¨ä¸»å¾ªç¯ä¸­åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ§åˆ¶çº¿ç¨‹åœ¨æ‰§è¡Œã€‚å¯¹ Python è™šæ‹Ÿæœºçš„è®¿é—®ç”± <em>å…¨å±€è§£é‡Šå™¨(GIL)</em> æ§åˆ¶ï¼Œè¿™ä¸ªé”ç”¨äºï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹æ—¶ä¿è¯åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œã€‚</p>

<p>ç”±äº Python çš„ GIL çš„é™åˆ¶ï¼Œå¤šçº¿ç¨‹æ›´é€‚åˆ I/O å¯†é›†å‹åº”ç”¨( I/O é‡Šæ”¾äº† GILï¼Œå¯ä»¥å…è®¸æ›´å¤šçš„å¹¶å‘)ï¼Œå¯¹äºè®¡ç®—å¯†é›†å‹åº”ç”¨ï¼Œä¸ºäº†å®ç°æ›´å¥½çš„å¹¶è¡Œæ€§ï¼Œé€‚åˆä½¿ç”¨å¤šè¿›ç¨‹ï¼Œå·²ä¾¿åˆ©ç”¨ CPU çš„å¤šæ ¸ä¼˜åŠ¿ã€‚Python çš„å¤šè¿›ç¨‹ç›¸å…³æ¨¡å—ï¼šsubprocessã€multiprocessingã€concurrent.futures</p>

<!--more-->

<h2 id="threading-æ¨¡å—">threading æ¨¡å—</h2>
<p>threading æ˜¯ Python é«˜çº§åˆ«çš„å¤šçº¿ç¨‹æ¨¡å—ã€‚</p>

<h3 id="threading-æ¨¡å—çš„å‡½æ•°">threading æ¨¡å—çš„å‡½æ•°</h3>
<ul>
  <li><strong>active_count()</strong>  å½“å‰æ´»åŠ¨çš„ Thread å¯¹è±¡ä¸ªæ•°</li>
  <li><strong>current_thread()</strong>  è¿”å›å½“å‰ Thread å¯¹è±¡</li>
  <li><strong>get_ident()</strong>  è¿”å›å½“å‰çº¿ç¨‹</li>
  <li><strong>enumerater()</strong>  è¿”å›å½“å‰æ´»åŠ¨ Thread å¯¹è±¡åˆ—è¡¨</li>
  <li><strong>main_thread()</strong>  è¿”å›ä¸» Thread å¯¹è±¡</li>
  <li><strong>settrace(func)</strong>  ä¸ºæ‰€æœ‰çº¿ç¨‹è®¾ç½®ä¸€ä¸ª trace å‡½æ•°</li>
  <li><strong>setprofile(func)</strong>  ä¸ºæ‰€æœ‰çº¿ç¨‹è®¾ç½®ä¸€ä¸ª profile å‡½æ•°</li>
  <li><strong>stack_size([size])</strong>  è¿”å›æ–°åˆ›å»ºçº¿ç¨‹æ ˆå¤§å°ï¼›æˆ–ä¸ºåç»­åˆ›å»ºçš„çº¿ç¨‹è®¾å®šæ ˆå¤§å°ä¸º size</li>
  <li><strong>TIMEOUT_MAX</strong>  <code class="highlighter-rouge">Lock.acquire()</code>, <code class="highlighter-rouge">RLock.acquire()</code>, <code class="highlighter-rouge">Condition.wait()</code> å…è®¸çš„æœ€å¤§å€¼</li>
</ul>

<p>threading å¯ç”¨å¯¹è±¡åˆ—è¡¨ï¼š</p>
<ul>
  <li><strong>Thread</strong> è¡¨ç¤ºæ‰§è¡Œçº¿ç¨‹çš„å¯¹è±¡</li>
  <li><strong>Lock</strong>  é”åŸè¯­å¯¹è±¡</li>
  <li><strong>RLock</strong>  å¯é‡å…¥é”å¯¹è±¡ï¼Œä½¿å•ä¸€è¿›ç¨‹å†æ¬¡è·å¾—å·²æŒæœ‰çš„é”(é€’å½’é”)</li>
  <li><strong>Condition</strong>  æ¡ä»¶å˜é‡å¯¹è±¡ï¼Œä½¿å¾—ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œæ¯”å¦‚æ”¹å˜çŠ¶æ€æˆ–æŸä¸ªå€¼</li>
  <li><strong>Semaphore</strong>  ä¸ºçº¿ç¨‹é—´å…±äº«çš„æœ‰é™èµ„æºæä¾›ä¸€ä¸ªâ€è®¡æ•°å™¨â€ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨èµ„æºä¼šè¢«é˜»å¡</li>
  <li><strong>Event</strong>  æ¡ä»¶å˜é‡çš„é€šç”¨ç‰ˆæœ¬ï¼Œä»»æ„æ•°é‡çš„çº¿ç¨‹ç­‰å¾…æŸä¸ªæ—¶é—´çš„å‘ç”Ÿï¼Œåœ¨æ”¹äº‹ä»¶å‘ç”Ÿåæ‰€æœ‰çº¿ç¨‹è¢«æ¿€æ´»</li>
  <li><strong>Timer</strong>  ä¸ Thread ç›¸è¯†ï¼Œä¸è¿‡å®ƒè¦åœ¨è¿è¡Œå‰ç­‰å¾…ä¸€æ®µæ—¶é—´</li>
  <li><strong>Barrier</strong>  åˆ›å»ºä¸€ä¸ªâ€é˜»ç¢â€ï¼Œå¿…é¡»è¾¾åˆ°æŒ‡å®šæ•°é‡çš„çº¿ç¨‹åæ‰å¯ä»¥ç»§ç»­</li>
</ul>

<h3 id="thread-ç±»">Thread ç±»</h3>
<p>Thread å¯¹è±¡çš„å±æ€§æœ‰ï¼š<code class="highlighter-rouge">Thread.name</code>ã€<code class="highlighter-rouge">Thread.ident</code>ã€<code class="highlighter-rouge">Thread.daemon</code>ã€‚è¯¦è§(<em>The Python Standard Library</em>)</p>

<p>Thread å¯¹è±¡æ–¹æ³•ï¼š<br />
<code class="highlighter-rouge">Thread.start()</code>ã€<code class="highlighter-rouge">Thread.run()</code>ã€<code class="highlighter-rouge">Thread.join(timeout=None)</code>ã€<code class="highlighter-rouge">Thread.getName</code>ã€<code class="highlighter-rouge">Thread.setName</code>ã€<code class="highlighter-rouge">Thread.is_alive()</code>ã€<code class="highlighter-rouge">Thread.isDaemon()</code>ã€<code class="highlighter-rouge">Thread.setDaemon()</code>ã€‚è¯¦è§(<em>The Python Standard Library</em>)</p>

<p>ä½¿ç”¨ Thread ç±»ï¼Œå¯ä»¥æœ‰å¾ˆå¤šç§æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹ï¼Œè¿™é‡Œä½¿ç”¨å¸¸è§çš„ä¸¤ç§ï¼š</p>

<ul>
  <li>åˆ›å»º Thread å®ä¾‹ï¼Œä¼ ç»™å®ƒä¸€ä¸ªå‡½æ•°ã€‚</li>
  <li>æ´¾ç”Ÿ Thread å­ç±»ï¼Œå¹¶åˆ›å»ºå­ç±»çš„å®ä¾‹ã€‚</li>
</ul>

<h3 id="ä¸€ä¸ªå•çº¿ç¨‹æ —å­">ä¸€ä¸ªå•çº¿ç¨‹æ —å­</h3>
<pre><code class="language-Python">#!/usr/bin/env python3

import threading
from random import randint
from time import sleep, ctime

def hi(n):
    sleep(n)
    print("ZzZzzz, sleep: ", n)    # æ‰“å° Sleep çš„ç§’æ•°

def main():
    print("### Start at: ", ctime())

    for i in range(10):
        hi(randint(1,2))    # è°ƒç”¨åæ¬¡ï¼Œæ¯æ¬¡ Sleep 1ç§’æˆ–2ç§’

    print("### Done at: ", ctime())

if __name__ == '__main__':
    main()
</code></pre>

<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="language-control">### Start at:  Thu Sep  1 14:11:00 2016
ZzZzzz, sleep:  1
ZzZzzz, sleep:  2
ZzZzzz, sleep:  2
ZzZzzz, sleep:  2
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  2
### Done at:  Thu Sep  1 14:11:14 2016
</code></pre>
<p>ä¸€å…±æ˜¯ç”¨äº†14ç§’ã€‚</p>

<h3 id="å¤šçº¿ç¨‹åˆ›å»º-thread-å®ä¾‹ä¼ ç»™å®ƒä¸€ä¸ªå‡½æ•°">å¤šçº¿ç¨‹ï¼šåˆ›å»º Thread å®ä¾‹ï¼Œä¼ ç»™å®ƒä¸€ä¸ªå‡½æ•°</h3>
<p>ç›´æ¥ä¸Šä»£ç ï¼š</p>
<pre><code class="language-Python">#!/usr/bin/env python3

import threading
from random import randint
from time import sleep, ctime

def hi(n):
    sleep(n)
    print("ZzZzzz, sleep: ", n)

def main():
    print("### Start at: ", ctime())
    threads = []

    for i in range(10):
        rands = randint(1,2)
        # å®ä¾‹åŒ–æ¯ä¸ª Thread å¯¹è±¡ï¼ŒæŠŠå‡½æ•°å’Œå‚æ•°ä¼ é€’è¿›å»ï¼Œè¿”å› Thread å®ä¾‹
        t = threading.Thread(target=hi, args=(rands,))
        threads.append(t)     # åˆ†é…çº¿ç¨‹

    for i in range(10):
        threads[i].start()    # å¼€å§‹æ‰§è¡Œå¤šçº¿ç¨‹

    for i in range(10):
        threads[i].join()     # (è‡ªæ—‹é”)ç­‰å¾…çº¿ç¨‹ç»“æŸæˆ–è¶…æ—¶ï¼Œç„¶åå†å¾€ä¸‹æ‰§è¡Œ

    print("### Done at: ", ctime())

if __name__ == '__main__':
    main()
</code></pre>

<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="language-control">### Start at:  Thu Sep  1 14:18:00 2016
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
ZzZzzz, sleep:  2
ZzZzzz, sleep:  2
ZzZzzz, sleep:  2
ZzZzzz, sleep:  2
### Done at:  Thu Sep  1 14:18:02 2016
</code></pre>
<p>ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œåªç”¨äº†2ç§’ã€‚</p>

<h3 id="å¤šçº¿ç¨‹æ´¾ç”Ÿ-thread-å­ç±»å¹¶åˆ›å»ºå­ç±»çš„å®ä¾‹">å¤šçº¿ç¨‹ï¼šæ´¾ç”Ÿ Thread å­ç±»ï¼Œå¹¶åˆ›å»ºå­ç±»çš„å®ä¾‹</h3>
<pre><code class="language-Python">#!/usr/bin/env python3

import threading
from random import randint
from time import sleep, ctime

class MyThread(threading.Thread):
 
    def __init__(self, func, args, times):
        super(MyThread, self).__init__()
        self.func = func
        self.args = args
        self.times = times
    
    def run(self):
        print("begin thread......", self.times)
        self.res = self.func(*self.args)
        print("end threads......", self.times)


def hi(n):
    sleep(n)
    print("ZzZzzz, sleep: ", n)

def main():
    print("### Start at: ", ctime())
    threads = []

    for i in range(10):
        rands = randint(1,2)
        t = MyThread(hi, (rands,), i+1)
        threads.append(t)

    for i in range(10):
        threads[i].start()

    for i in range(10):
        threads[i].join()

    print("### Done at: ", ctime())

if __name__ == '__main__':
    main()
</code></pre>

<p>æ‰§è¡Œç»“æœï¼š</p>
<pre><code class="language-control">### Start at:  Thu Sep  1 14:47:09 2016
begin thread...... 1
begin thread...... 2
begin thread...... 3
begin thread...... 4
begin thread...... 5
begin thread...... 6
begin thread...... 7
begin thread...... 8
begin thread...... 9
begin thread...... 10
ZzZzzz, sleep:  1
ZzZzzz, sleep:  1
end threads...... 1
end threads...... 4
ZzZzzz, sleep:  1
end threads...... 7
ZzZzzz, sleep:  1
end threads...... 3
ZzZzzz, sleep:  1
end threads...... 9
ZzZzzz, sleep:  2
end threads...... 2
ZzZzzz, sleep:  2
end threads...... 5
ZzZzzz, sleep:  2
ZzZzzz, sleep:  2
end threads...... 10
end threads...... 6
ZzZzzz, sleep:  2
end threads...... 8
### Done at:  Thu Sep  1 14:47:11 2016
</code></pre>
<p>è¿™ä¸ªæ —å­å¯¹ Thread å­ç±»åŒ–ï¼Œè€Œä¸æ˜¯å¯¹å…¶å®ä¾‹åŒ–ï¼Œä½¿å¾—å®šåˆ¶çº¿ç¨‹å¯¹è±¡æ›´å…·çµæ´»æ€§ï¼ŒåŒæ—¶ä¹Ÿç®€åŒ–çº¿ç¨‹åˆ›å»ºçš„è°ƒç”¨è¿‡ç¨‹ã€‚</p>

<h2 id="çº¿ç¨‹é”">çº¿ç¨‹é”</h2>
<p>å½“å¤šçº¿ç¨‹äº‰å¤ºé”æ—¶ï¼Œå…è®¸ç¬¬ä¸€ä¸ªè·å¾—é”çš„çº¿ç¨‹è¿›å…¥ä¸´è¡—åŒºï¼Œå¹¶æ‰§è¡Œä»£ç ã€‚æ‰€æœ‰ä¹‹ååˆ°è¾¾çš„çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œé€€å‡ºä¸´è¡—åŒºï¼Œå¹¶é‡Šæ”¾é”ã€‚éœ€è¦æ³¨æ„ï¼Œé‚£äº›é˜»å¡çš„çº¿ç¨‹æ˜¯æ²¡æœ‰é¡ºåºçš„ã€‚</p>

<p>ä¸¾ä¸ªæ —å­ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span><span class="p">,</span> <span class="n">ctime</span>


<span class="n">L</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Lock</span><span class="p">()</span>    <span class="c1"># å¼•å…¥é”
</span>

<span class="k">def</span> <span class="nf">hi</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">L</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>    <span class="c1"># åŠ é”
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">sleep</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ZzZzzz, sleep: "</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">L</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>    <span class="c1"># é‡Šæ”¾é”
</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### Start at: "</span><span class="p">,</span> <span class="n">ctime</span><span class="p">())</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">rands</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">rands</span><span class="p">,))</span>
        <span class="n">threads</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">threads</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">threads</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">join</span><span class="p">()</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"### Done at: "</span><span class="p">,</span> <span class="n">ctime</span><span class="p">())</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œå†å°†é”çš„ä»£ç æ³¨é‡Šæ‰ï¼Œå¯¹æ¯”ä¸‹è¾“å‡ºã€‚</p>

    </div>

    <a class="u-url" href="/2017/python-threading.html" hidden></a>
</article>

<div class="post-tags">
    
    <a>threading</a>
    
    <a>Python</a>
    
</div>

<div class="pagination">
    <ul>
        
        <li class="prev">
            <a href="/2016/python-syntactic-sugar.html" title="PREV: Python è¯­æ³•ç³–">
                â€¹ Python è¯­æ³•ç³–
            </a>
        </li>
        
        
        <li class="next">
            <a href="/2017/python-logging.html" title="NEXT: Python Logging">
                â€º Python Logging
            </a>
        </li>
        
    </ul>
</div>
    </div>
</main><footer>
    <p class="post-author"><a href="/">ZZIR</a></p>
</footer>
<script defer src="/assets/js/katex/katex.min.js" type="text/javascript"></script>
<script defer src="/assets/js/katex/auto-render.min.js" type="text/javascript"></script>
<script src="/assets/js/zooming.min.js" type="text/javascript"></script>
<script src="/assets/js/highlight.pack.js" type="text/javascript"></script>
<script>
    // zooming
    const zooming = new Zooming({
        customSize: '100%',
    });
    zooming.listen('.paragraph img');
    zooming.listen('.content img');
    zooming.listen('.post-content img');

    // highlight
    hljs.initHighlightingOnLoad();

    // katex
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false},
                {left: "\\(", right: "\\)", display: false},
                {left: "\\[", right: "\\]", display: true}
            ]
        });
    });

    // back display
    function getScrollTop() {
        var scrollTop = 0;
        if (document.documentElement && document.documentElement.scrollTop) {
            scrollTop = document.documentElement.scrollTop;
        } else if (document.body) {
            scrollTop = document.body.scrollTop;
        }
        return scrollTop;
    }

    window.onscroll = function () {
        if (getScrollTop() === 0) {
            document.getElementById("post-back").style.display = "block";
        }
    }
</script>


<script>
    // google analytics
    window.ga = window.ga || function () {
        (ga.q = ga.q || []).push(arguments)
    };
    ga.l = +new Date;
    ga('create', 'UA-121779014-1', 'auto');
    ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>